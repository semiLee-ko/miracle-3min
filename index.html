<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>3분의 기적 - 배달 참기 프로젝트</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    spacing: {
                        'safe-top': 'env(safe-area-inset-top)',
                        'safe-bottom': 'env(safe-area-inset-bottom)',
                        'safe-left': 'env(safe-area-inset-left)',
                        'safe-right': 'env(safe-area-inset-right)',
                    }
                }
            }
        }
    </script>
    <style>
        :root {
            --sat: env(safe-area-inset-top);
            --sab: env(safe-area-inset-bottom);
            --sal: env(safe-area-inset-left);
            --sar: env(safe-area-inset-right);
        }

        body {
            padding-top: var(--sat);
            padding-bottom: var(--sab);
            padding-left: var(--sal);
            padding-right: var(--sar);
        }
    </style>
    <!-- Import Map for Firebase (fixes module resolution in browser) -->
    <script type="importmap">
    {
      "imports": {
        "firebase/app": "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js",
        "firebase/auth": "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js"
      }
    }
    </script>
    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Noto+Sans+KR:wght@300;400;700;900&display=swap"
        rel="stylesheet">
    <!-- Local Styles -->
    <link rel="stylesheet" href="src/styles.css">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>

    <!-- Mobile App Container -->
    <div id="app-frame" class="text-white relative">


        <!-- Animated Background Particles -->
        <div class="bg-particles">
            <div class="particle"
                style="left: 10%; width: 15px; height: 15px; animation-duration: 7s; animation-delay: 0s;">
            </div>
            <div class="particle"
                style="left: 30%; width: 20px; height: 20px; animation-duration: 9s; animation-delay: 2s;">
            </div>
            <div class="particle"
                style="left: 50%; width: 10px; height: 10px; animation-duration: 6s; animation-delay: 4s;">
            </div>
            <div class="particle"
                style="left: 70%; width: 18px; height: 18px; animation-duration: 11s; animation-delay: 1s;">
            </div>
            <div class="particle"
                style="left: 90%; width: 12px; height: 12px; animation-duration: 8s; animation-delay: 3s;">
            </div>
            <div class="particle"
                style="left: 20%; width: 8px; height: 8px; animation-duration: 10s; animation-delay: 5s;"></div>
            <div class="particle"
                style="left: 60%; width: 14px; height: 14px; animation-duration: 7.5s; animation-delay: 2.5s;">
            </div>
        </div>

        <!-- HEADER -->
        <header class="absolute top-0 w-full p-6 flex justify-between items-start z-50 text-white pointer-events-none">
            <div class="flex items-center gap-2 mt-1 pointer-events-auto">
                <span class="font-black text-xl tracking-tighter text-white drop-shadow-md italic">
                    침착해<span class="text-yellow-300">3분</span>
                </span>
                <!-- Help Button -->
                <button id="btn-help" class="ml-2 text-white/50 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </button>
            </div>
            <div class="flex flex-col items-end min-w-[140px]">
                <div class="text-[10px] opacity-80 mb-1 font-bold mr-[10px]">이번달 당신의 인내로</div>
                <div
                    class="bg-white/20 backdrop-blur-md rounded-full px-3 py-1 text-xs font-bold border border-white/30 flex items-center gap-2 whitespace-nowrap">
                    <span class="bg-yellow-400 rounded-full w-2 h-2"></span>
                    <span id="total-savings-display">0</span>원 세이브
                </div>
            </div>
        </header>

        <!-- 1. INTRO SECTION -->
        <section id="intro-screen"
            class="w-full h-full relative z-20 flex flex-col landscape:flex-row items-center justify-center p-8 transition-opacity duration-1000">

            <!-- Left Half (Landscape): Character + Start Button -->
            <div
                class="w-full landscape:w-1/2 flex flex-col items-center justify-center landscape:h-full landscape:relative">
                <!-- Character Animation -->
                <div class="character-container mb-12 landscape:mb-0 relative">
                    <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="100" cy="100" r="90" fill="white" fill-opacity="0.1" />
                        <path class="char-body"
                            d="M43.6,-57.3C55.3,-46.2,62.8,-30.9,64.8,-15.2C66.8,0.5,63.3,16.6,53.8,29.1C44.3,41.6,28.8,50.5,12.7,53.8C-3.4,57.1,-20.1,54.8,-34.7,46.1C-49.3,37.4,-61.8,22.3,-64.5,5.6C-67.2,-11.1,-60.1,-29.4,-47.5,-41.2C-34.9,-53,-16.8,-58.3,-0.2,-58C16.4,-57.8,31.9,-68.4,43.6,-57.3Z"
                            transform="translate(100 100) scale(1.1)" />
                        <circle class="char-eye" cx="75" cy="90" r="5" style="transform-origin: 75px 90px" />
                        <circle class="char-eye" cx="125" cy="90" r="5" style="transform-origin: 125px 90px" />
                        <ellipse class="char-blush" cx="65" cy="110" rx="6" ry="3" />
                        <ellipse class="char-blush" cx="135" cy="110" rx="6" ry="3" />
                        <path class="char-mouth" d="M85 110 Q100 125 115 110" stroke-linecap="round" fill="none" />
                    </svg>
                </div>

                <!-- Start Button: Absolute in Portrait / Landscape Absolute Bottom -->
                <button id="start-btn"
                    class="absolute bottom-12 left-1/2 -translate-x-1/2 w-[85%] max-w-xs btn-pop text-lg shadow-[0_8px_0_#E5BC2E] active:shadow-none translate-y-0 active:translate-y-2 transition-opacity opacity-0 landscape:absolute landscape:bottom-0 landscape:h-[3rem] landscape:flex landscape:items-center landscape:justify-center">
                    딱 3분만 참기 시작
                </button>
            </div>

            <!-- Right Half (Landscape): Quote -->
            <div class="w-full landscape:w-1/2 flex flex-col items-center justify-center landscape:h-full">
                <!-- Emotional Quote Area -->
                <div class="text-center w-full max-w-xs flex flex-col items-center">
                    <div
                        class="inline-flex items-center justify-center gap-2 px-4 py-2 rounded-xl bg-gradient-to-br from-white/20 to-white/5 border border-white/20 shadow-lg backdrop-blur-sm mb-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-yellow-300 drop-shadow" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
                        </svg>
                        <span class="text-xs font-bold text-white">오늘의 팩트</span>
                    </div>

                    <h1 id="quote-text"
                        class="text-[clamp(1.1rem,4.5vw,1.5rem)] font-bold leading-relaxed text-white mb-2 drop-shadow-lg opacity-0 break-keep transition-all duration-300">
                        오늘 먹을 치킨을 내일로 미루면,<br>통장 잔고가 웃는다.
                    </h1>
                </div>
            </div>

        </section>

        <!-- 2. MAIN TIMER SCREEN -->
        <section id="main-screen"
            class="hidden w-full h-full relative z-20 flex flex-col max-lg:landscape:flex-row max-lg:landscape:items-center max-lg:landscape:justify-center pt-16 max-lg:landscape:pt-0 max-lg:landscape:p-8 max-lg:landscape:gap-8">

            <div
                class="flex-1 flex flex-col items-center justify-center min-h-0 relative w-full max-lg:landscape:w-1/2 max-lg:landscape:h-full max-lg:landscape:pt-12">
                <div class="character-container scale-110 max-lg:landscape:scale-90 max-lg:landscape:mb-2">
                    <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <radialGradient id="pale-gradient" cx="50%" cy="40%" r="60%" fx="50%" fy="40%">
                                <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:0.6" />
                                <stop offset="100%" style="stop-color:#3B82F6;stop-opacity:0" />
                            </radialGradient>
                        </defs>
                        <!-- Body -->
                        <path class="char-body" id="main-blob-body"
                            d="M38.1,-53.4C49.9,-44.2,60.4,-34.3,64.9,-22.3C69.4,-10.3,67.9,3.9,61.9,15.8C55.9,27.7,45.4,37.3,34.2,46.1C23,54.9,11.1,62.9,-1.9,65.5C-14.9,68.1,-27,65.3,-37.2,57.7C-47.4,50.1,-55.7,37.7,-60.7,24.3C-65.7,10.9,-67.4,-3.5,-61.8,-15.8C-56.2,-28.1,-43.3,-38.3,-30.4,-47C-17.5,-55.7,-4.6,-62.9,6.2,-71.4C17,-79.9,26.3,-62.6,38.1,-53.4Z"
                            transform="translate(100 100)" />

                        <!-- Pale Effect (Initially Hidden) -->
                        <ellipse id="pale-effect" class="char-pale-effect" cx="100" cy="50" rx="60" ry="40"
                            opacity="0" />

                        <!-- Face -->
                        <g id="main-blob-face">
                            <circle class="char-eye" cx="80" cy="90" r="6" style="transform-origin: 80px 90px" />
                            <circle class="char-eye" cx="120" cy="90" r="6" style="transform-origin: 120px 90px" />
                            <path id="sweat-drop" fill="#A5F3FC"
                                d="M135 70 Q135 60 140 70 Q145 80 135 80 Q125 80 130 70" opacity="0" />
                            <path class="char-mouth" d="M90 115 L110 115" />
                        </g>
                    </svg>
                </div>
                <div
                    class="text-white text-center mt-[-10px] max-lg:landscape:mt-[-20px] relative z-10 mb-4 max-lg:landscape:w-full">
                    <div id="status-message" class="text-sm opacity-80 font-bold tracking-widest mb-1 min-h-[1.25rem]">
                        괜찮아. 아직 안 눌렀어.</div>
                    <div id="timer-display" class="text-5xl font-black drop-shadow-lg tracking-tighter">03:00
                    </div>
                    <div class="mt-4 max-lg:landscape:mt-0 flex flex-col items-center">
                        <label for="savings-input" class="text-xs font-bold opacity-70 mb-1">절약할 배달비</label>
                        <div class="relative">
                            <input type="text" id="savings-input" value="25,000" inputmode="numeric"
                                class="bg-white/20 backdrop-blur-md rounded-2xl py-2 pr-4 text-right text-[1.3rem] font-black text-white w-40 outline-none border border-white/30 focus:bg-white/30 transition-all placeholder-white/50">
                            <span
                                class="absolute left-3 top-1/2 -translate-y-1/2 text-xl font-bold opacity-80 pointer-events-none">₩</span>
                        </div>
                    </div>
                </div>
            </div>

            <div
                class="main-card flex-none animate-[slideUp_0.5s_ease-out] max-lg:landscape:w-[40%] max-lg:landscape:h-auto max-lg:landscape:min-h-[auto] max-lg:landscape:self-end max-lg:landscape:mb-0 max-lg:landscape:p-3 max-lg:landscape:rounded-[2rem] max-lg:landscape:flex max-lg:landscape:flex-col max-lg:landscape:justify-center max-lg:landscape:shadow-2xl">

                <h3 class="title-pop text-lg mb-2 text-left px-2 max-lg:landscape:mb-1 max-lg:landscape:text-sm">
                    위기
                    탈출 도구</h3>
                <div class="grid grid-cols-2 gap-2 mb-3 max-lg:landscape:gap-2 max-lg:landscape:mb-1">
                    <!-- Blue Glasses -->
                    <button id="btn-blue" class="btn-secondary btn-blue group max-lg:landscape:justify-center">
                        <div class="icon-box max-lg:landscape:!hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M2 10s3-3 8-3 8 3 8 3v4s-3 3-8 3-8-3-8-3v-4zm3 2h2m8 0h2" />
                                <circle cx="6" cy="12" r="2" class="opacity-30" />
                                <circle cx="18" cy="12" r="2" class="opacity-30" />
                            </svg>
                        </div>
                        <span class="text-sm font-bold">식욕감퇴술</span>
                    </button>

                    <button id="btn-game" class="btn-secondary btn-green group max-lg:landscape:justify-center">
                        <div class="icon-box max-lg:landscape:!hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z" />
                                <circle cx="9" cy="9" r="1" fill="currentColor" class="text-green-600" />
                                <rect x="13" y="8" width="4" height="2" rx="1" fill="currentColor"
                                    class="text-green-600" />
                            </svg>
                        </div>
                        <span class="text-sm font-bold">멍때리기</span>
                    </button>

                    <button id="btn-labor" class="btn-secondary btn-yellow group max-lg:landscape:justify-center">
                        <div class="icon-box max-lg:landscape:!hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <span class="text-sm font-bold">금융치료</span>
                    </button>

                    <button id="btn-breathe" class="btn-secondary btn-purple group max-lg:landscape:justify-center">
                        <div class="icon-box max-lg:landscape:!hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <span class="text-sm font-bold">심호흡</span>
                    </button>
                </div>
                <div class="text-center mt-1 max-lg:landscape:mt-0">
                    <button id="btn-giveup"
                        class="text-gray-400 text-[0.7rem] font-bold underline px-4 py-1 hover:text-gray-600 transition-colors">
                        못 참겠어요 (포기하기)
                    </button>
                </div>
            </div>
        </section>

        <!-- 3. TOOLS & GAMES (Overlays) -->

        <!-- Blue Filter Modal -->
        <div id="blue-modal"
            class="hidden absolute inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-[fadeIn_0.2s_ease-out]">
            <div class="bg-white rounded-[2rem] w-full max-w-sm shadow-2xl overflow-hidden flex flex-col max-h-[90vh]">
                <div class="p-5 flex justify-between items-center bg-white shrink-0">
                    <h2 class="font-black text-xl text-gray-800 tracking-tight">식욕감퇴술</h2>
                    <button
                        class="btn-close-tool w-10 h-10 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 flex items-center justify-center transition-colors"
                        data-tool="blue">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor" stroke-width="2.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <div class="p-5 pt-0 overflow-y-auto hidden-scrollbar">
                    <div
                        class="w-full aspect-square bg-gray-100 rounded-2xl mb-5 overflow-hidden relative shadow-inner group">
                        <img id="food-preview"
                            src="https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80"
                            alt="음식 사진" class="w-full h-full object-cover transition-all duration-500">
                        <div
                            class="absolute bottom-4 right-4 bg-black/70 text-white text-xs px-3 py-1 rounded-full font-bold">
                            식욕 감퇴 모드 ON
                        </div>
                    </div>

                    <div class="flex gap-3 w-full mb-3 shrink-0">
                        <button id="btn-blue-weak"
                            class="flex-1 bg-blue-50 hover:bg-blue-100 text-blue-500 py-3 rounded-xl font-bold transition-colors text-sm">
                            맛없게
                        </button>
                        <button id="btn-blue-strong"
                            class="flex-1 bg-blue-100 hover:bg-blue-200 text-blue-600 py-3 rounded-xl font-bold transition-colors text-sm">
                            더 맛없게
                        </button>
                    </div>

                    <div class="w-full">
                        <button onclick="appLogic.triggerAlbum()"
                            class="w-full bg-gray-900 text-white py-4 rounded-xl font-bold text-center cursor-pointer hover:bg-gray-800 transition-colors shadow-lg active:scale-[0.98] flex items-center justify-center gap-2">
                            <span>사진 올리기</span>
                        </button>
                        <input type="file" id="image-upload" accept="image/*" class="hidden">
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Modal (Refactored to Chill Modal) -->
        <div id="game-modal"
            class="hidden absolute inset-0 z-50 bg-[#5B4DFF] flex flex-col animate-[slideUp_0.3s_ease-out]">
            <div class="p-4 flex justify-between items-center shrink-0 z-10">
                <div class="flex flex-col items-start px-1">
                    <h2 class="font-black text-xl text-white tracking-tight leading-none mb-2">멍때리기</h2>
                    <p class="text-white/70 text-xs font-bold">3분만... 아무 생각 없이 쉬세요.</p>
                </div>
                <button
                    class="btn-close-tool w-12 h-12 rounded-full bg-white/20 hover:bg-white/30 text-white flex items-center justify-center transition-colors shrink-0 backdrop-blur-sm"
                    data-tool="game">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <div class="flex-1 relative min-h-0 bg-white m-5 mt-0 rounded-3xl overflow-hidden shadow-2xl border-4 border-white/10"
                id="game-area">
                <iframe id="chill-frame" class="w-full h-full border-0 bg-black"></iframe>
            </div>
        </div>

        <!-- Labor Calculator Modal -->
        <div id="labor-modal"
            class="hidden absolute inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-[fadeIn_0.2s_ease-out]">
            <div class="bg-white rounded-[2rem] w-full max-w-sm shadow-2xl overflow-hidden flex flex-col max-h-[90vh]">
                <div class="p-5 flex justify-between items-center bg-white shrink-0">
                    <h2 class="font-black text-xl text-gray-800 tracking-tight">금융치료</h2>
                    <button
                        class="btn-close-tool w-10 h-10 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 flex items-center justify-center transition-colors"
                        data-tool="labor">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor" stroke-width="2.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <div class="p-6 space-y-4 overflow-y-auto">
                    <!-- Top Section: Split Layout -->
                    <div class="grid grid-cols-2 gap-3 h-24">
                        <!-- Left: Expense Roller -->
                        <div id="expense-roller"
                            class="relative h-full overflow-hidden bg-gray-50 rounded-2xl border border-gray-100 flex items-center justify-center p-2 text-center">
                            <div id="roller-content"
                                class="text-xs font-bold text-gray-600 transition-transform duration-500 ease-in-out transform translate-y-0 break-keep leading-tight">
                                <!-- Dynamic Content -->
                            </div>
                        </div>

                        <!-- Right: Wage Input -->
                        <div
                            class="bg-yellow-50 p-3 rounded-2xl border border-yellow-100 flex flex-col justify-center h-full">
                            <label class="font-bold text-[10px] text-yellow-600 mb-1 block">내 시급 (원)</label>
                            <input type="text" id="hourly-wage" value="9,860" inputmode="numeric"
                                class="w-full bg-transparent font-black text-xl text-gray-800 outline-none placeholder-gray-300 text-right p-0">
                        </div>
                    </div>

                    <!-- Bottom Section: Labor Result (Always Visible) -->
                    <div id="labor-result" class="pt-2 text-center pb-2">
                        <p class="text-gray-400 text-xs font-bold mb-1">이 음식을 먹으려면</p>
                        <div class="text-4xl font-black text-[#5B4DFF] leading-none mb-1">
                            <span id="labor-hours">0</span><span class="text-2xl ml-1">시간</span>
                            <span id="labor-minutes">0</span><span class="text-2xl ml-1">분</span>
                        </div>
                        <p class="text-gray-400 text-[10px]">동안 더 일해야 합니다</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- Breathing Modal -->
        <div id="breathe-modal"
            class="hidden absolute inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-[fadeIn_0.2s_ease-out]">
            <div
                class="bg-white rounded-[2rem] w-full max-w-sm shadow-2xl overflow-hidden flex flex-col relative max-h-[90vh]">
                <div class="p-5 flex justify-between items-center bg-white shrink-0 z-10">
                    <h2 class="font-black text-xl text-[#5B4DFF] tracking-tight">심호흡</h2>
                    <button
                        class="btn-close-tool w-10 h-10 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 flex items-center justify-center transition-colors"
                        data-tool="breathe">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor" stroke-width="2.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <div class="p-10 flex flex-col items-center justify-start flex-1 min-h-0 overflow-y-auto">
                    <div class="relative flex items-center justify-center mb-8 shrink-0">
                        <div
                            class="w-40 h-40 bg-[#5B4DFF]/10 rounded-full flex items-center justify-center shadow-inner animate-breathe z-10">
                            <div class="w-full h-full rounded-full bg-[#5B4DFF]/30 flex items-center justify-center shadow-lg text-[#5B4DFF] font-black text-xl transition-all duration-500"
                                id="breath-text">준비...</div>
                        </div>
                        <div
                            class="absolute w-[11rem] h-[11rem] border-2 border-[#5B4DFF]/20 rounded-full animate-[spin_10s_linear_infinite] z-0">
                        </div>
                    </div>

                    <div class="text-center w-full relative z-10 pb-4">
                        <p class="text-[#5B4DFF] font-bold opacity-80 mb-3 text-sm tracking-wider uppercase">
                            4-7-8 호흡법
                        </p>
                        <div class="bg-[#5B4DFF]/5 p-4 rounded-xl text-xs text-gray-600 leading-relaxed break-keep">
                            충동이 느껴질 때 딱 5번만 반복해보세요.<br>
                            <span class="text-[#5B4DFF] font-bold">4초</span> 들이마시고, <span
                                class="text-[#5B4DFF] font-bold">7초</span> 멈추고, <span
                                class="text-[#5B4DFF] font-bold">8초</span> 내뱉습니다.
                        </div>
                    </div>
                </div>
            </div>
        </div><!-- 4. RESULT SECTION -->

        <!-- Help Modal -->
        <div id="help-modal"
            class="hidden absolute inset-0 z-[70] bg-black/60 backdrop-blur-sm flex items-center justify-center p-6 animate-[fadeIn_0.2s_ease-out]">
            <div
                class="bg-white rounded-[2rem] w-full max-w-sm shadow-2xl overflow-hidden flex flex-col p-6 text-left max-h-[85vh] overflow-y-auto">
                <h3 class="text-gray-900 font-black text-xl mb-4 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-[#5B4DFF]" fill="none"
                        viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    침착해 3분 사용법
                </h3>
                <div class="space-y-4 text-sm text-gray-600 leading-relaxed font-medium">
                    <div class="bg-gray-50 p-4 rounded-xl">
                        <p class="font-bold text-gray-800 mb-1">⏱️ 딱 3분만 참아보세요!</p>
                        <p>배달 음식을 주문하고 싶은 충동은 보통 3분만 참으면 사라집니다. 타이머가 끝날 때까지 다양한 도구로 위기를 넘겨보세요.</p>
                    </div>

                    <div class="space-y-2">
                        <p class="font-bold text-gray-800">🛠️ 위기 탈출 도구</p>
                        <ul class="list-disc pl-4 space-y-1 text-xs">
                            <li><span class="text-[#5B4DFF] font-bold">식욕 감퇴짤</span>: 입맛 뚝 떨어지는 파란 필터</li>
                            <li><span class="text-green-600 font-bold">멍때리기</span>: 아무 생각 없이 시간 떼우기</li>
                            <li><span class="text-orange-500 font-bold">금융 치료</span>: 이 돈이면 살 수 있는 것들 비교</li>
                            <li><span class="text-purple-600 font-bold">심호흡</span>: 4-7-8 호흡법으로 진정하기</li>
                        </ul>
                    </div>

                    <div class="bg-blue-50 p-3 rounded-xl text-blue-800 text-xs">
                        💡 <b>Tip:</b> 하루 5번 성공하면 보상형 광고를 시청하고 계속 기록할 수 있어요!
                    </div>
                </div>
                <button id="btn-reset-data"
                    class="mt-4 bg-red-100 text-red-500 py-3 rounded-xl font-bold text-sm hover:bg-red-200 active:scale-[0.98] transition-all w-full shrink-0">
                    데이터 초기화 (테스트용)
                </button>

                <button id="btn-close-help"
                    class="mt-2 bg-gray-900 text-white py-3 rounded-xl font-bold shadow-lg active:scale-[0.98] transition-transform w-full shrink-0">
                    알겠어요!
                </button>
            </div>
        </div>

        <!-- Generic Alert Modal -->
        <div id="alert-modal"
            class="hidden absolute inset-0 z-[60] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-[fadeIn_0.2s_ease-out]">
            <div
                class="bg-white rounded-[2rem] w-full max-w-xs shadow-2xl overflow-hidden flex flex-col p-6 text-center max-h-[85vh] overflow-y-auto">
                <h3 class="text-gray-800 font-bold text-lg mb-2">잠깐만요!</h3>
                <p id="alert-message" class="text-gray-600 text-sm mb-6 break-keep leading-relaxed"></p>
                <button id="btn-close-alert"
                    class="bg-[#5B4DFF] text-white py-3 rounded-xl font-bold shadow-lg active:scale-[0.98] transition-transform w-full shrink-0">
                    확인
                </button>
            </div>
        </div>

        <!-- Generic Confirm Modal -->
        <div id="confirm-modal"
            class="hidden absolute inset-0 z-[60] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-[fadeIn_0.2s_ease-out]">
            <div
                class="bg-white rounded-[2rem] w-full max-w-xs shadow-2xl overflow-hidden flex flex-col p-6 text-center max-h-[85vh] overflow-y-auto">
                <h3 class="text-gray-800 font-bold text-lg mb-2">정말 포기하시겠어요?</h3>
                <p id="confirm-message" class="text-gray-600 text-sm mb-6 break-keep leading-relaxed"></p>
                <div class="flex gap-3 shrink-0">
                    <button id="btn-cancel-confirm"
                        class="flex-1 bg-gray-100 text-gray-500 py-3 rounded-xl font-bold active:scale-[0.98] transition-transform">
                        아니요
                    </button>
                    <button id="btn-ok-confirm"
                        class="flex-1 bg-red-500 text-white py-3 rounded-xl font-bold shadow-lg active:scale-[0.98] transition-transform">
                        포기할래요
                    </button>
                </div>
            </div>
        </div>

        <section id="result-screen"
            class="hidden w-full h-full relative z-20 flex flex-col bg-[#5B4DFF] items-center pt-20 max-lg:landscape:pt-0 text-white text-center max-lg:landscape:flex-row max-lg:landscape:justify-center max-lg:landscape:items-center max-lg:landscape:gap-2">
            <div
                class="flex-1 flex flex-col items-center justify-center min-h-0 h-1/2 max-lg:landscape:w-[35%] max-lg:landscape:flex-none max-lg:landscape:h-full">
                <!-- Daily Count Display -->
                <div id="today-count-display"
                    class="font-bold text-sm bg-white/20 backdrop-blur-md px-4 py-1.5 rounded-full mb-4 animate-bounce border border-white/30 shadow-lg">
                    오늘 참은 횟수 : <span class="text-yellow-300">0</span>/5회
                </div>

                <!-- Floating Happy Character -->
                <div
                    class="character-container mb-4 scale-125 max-lg:landscape:scale-100 shrink-0 relative h-[40%] aspect-square w-auto min-h-0 max-h-[180px]">
                    <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" class="w-full h-full block">
                        <!-- Halo -->
                        <circle cx="100" cy="100" r="90" fill="white" fill-opacity="0.2" />
                        <!-- Body -->
                        <path class="char-body"
                            d="M43.6,-57.3C55.3,-46.2,62.8,-30.9,64.8,-15.2C66.8,0.5,63.3,16.6,53.8,29.1C44.3,41.6,28.8,50.5,12.7,53.8C-3.4,57.1,-20.1,54.8,-34.7,46.1C-49.3,37.4,-61.8,22.3,-64.5,5.6C-67.2,-11.1,-60.1,-29.4,-47.5,-41.2C-34.9,-53,-16.8,-58.3,-0.2,-58C16.4,-57.8,31.9,-68.4,43.6,-57.3Z"
                            transform="translate(100 100) scale(1.1)" />
                        <!-- Normal Eyes -->
                        <circle class="char-eye" cx="75" cy="90" r="5" style="transform-origin: 75px 90px" />
                        <circle class="char-eye" cx="125" cy="90" r="5" style="transform-origin: 125px 90px" />
                        <!-- Blush -->
                        <ellipse class="char-blush" cx="60" cy="110" rx="7" ry="4" />
                        <ellipse class="char-blush" cx="140" cy="110" rx="7" ry="4" />
                        <!-- Gentle Smile (Same as Intro) -->
                        <path class="char-mouth" d="M85 110 Q100 125 115 110" stroke="#2D2D2D" stroke-width="4"
                            stroke-linecap="round" fill="none" />
                    </svg>
                </div>
                <h1 class="font-black text-3xl mb-2 max-lg:landscape:text-2xl shrink-0">참기 성공!</h1>
                <p class="opacity-80 text-sm max-lg:landscape:text-xs shrink-0">위장도 지갑도 당신을 자랑스러워합니다.</p>
            </div>
            <div
                class="main-card h-1/2 w-full pb-6 flex flex-col min-h-0 max-lg:landscape:w-[63%] max-lg:landscape:pb-0 max-lg:landscape:mr-4 max-lg:landscape:h-auto max-lg:landscape:self-end max-lg:landscape:mb-0 max-lg:landscape:max-h-[90vh]">
                <div class="flex justify-around mb-4 max-lg:landscape:mb-4 shrink-0">
                    <div>
                        <div class="text-gray-400 text-xs font-bold mb-1">이번주 절약한 돈</div>
                        <div class="text-2xl font-black text-green-500">₩<span id="result-money">0</span></div>
                    </div>
                    <div>
                        <div class="text-gray-400 text-xs font-bold mb-1">이번주 성공 횟수</div>
                        <div class="text-2xl font-black text-orange-500"><span id="success-count-display">0</span><span
                                class="text-sm">회</span></div>
                    </div>
                </div>
                <div
                    class="bg-gray-50 rounded-2xl p-4 mb-4 relative flex-1 min-h-0 w-full max-lg:landscape:h-32 max-lg:landscape:mb-4 max-lg:landscape:flex-none">
                    <canvas id="savingsChart"></canvas>
                </div>
                <button id="btn-restart"
                    class="btn-pop max-lg:landscape:py-3 max-lg:landscape:text-base max-lg:landscape:mb-2 shrink-0 btn-restart-custom">
                    <span class="text-sm">광고 시청하고</span><br>
                    <span class="text-base font-bold">참은 횟수 기록하기</span>
                </button>
            </div>
        </section>

    </div>

    <!-- Main Logic -->
    <script type="module" src="src/main.js"></script>
</body>

</html>